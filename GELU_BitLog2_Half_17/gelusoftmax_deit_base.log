Namespace(model='deit_base', dataset='dataset/imagenet/', calib_batchsize=32, val_batchsize=200, num_workers=8, device='cuda', print_freq=100, seed=0, w_bits=4, a_bits=4, log_quant_scheme='BitLog2_Half_17')
Building dataloader ...
Building model ...
Performing initial quantization ...
self.delta: 311.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0032, 0.0064, 0.0096, 0.0129, 0.0193, 0.0257, 0.0386, 0.0514,
        0.0772, 0.1029, 0.1543, 0.2058, 0.3087, 0.4116, 0.6174, 0.8232],
       device='cuda:0')

self.delta: 333.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0030, 0.0060, 0.0090, 0.0120, 0.0180, 0.0240, 0.0360, 0.0480,
        0.0721, 0.0961, 0.1441, 0.1922, 0.2883, 0.3844, 0.5766, 0.7688],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 285.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0035, 0.0070, 0.0105, 0.0140, 0.0211, 0.0281, 0.0421, 0.0561,
        0.0842, 0.1123, 0.1684, 0.2246, 0.3368, 0.4491, 0.6737, 0.8982],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 340.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0029, 0.0059, 0.0088, 0.0118, 0.0176, 0.0235, 0.0353, 0.0471,
        0.0706, 0.0941, 0.1412, 0.1882, 0.2824, 0.3765, 0.5647, 0.7529],
       device='cuda:0')

self.delta: 311.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0032, 0.0064, 0.0096, 0.0129, 0.0193, 0.0257, 0.0386, 0.0514,
        0.0772, 0.1029, 0.1543, 0.2058, 0.3087, 0.4116, 0.6174, 0.8232],
       device='cuda:0')

self.delta: 331.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0030, 0.0060, 0.0091, 0.0121, 0.0181, 0.0242, 0.0363, 0.0483,
        0.0725, 0.0967, 0.1450, 0.1934, 0.2900, 0.3867, 0.5801, 0.7734],
       device='cuda:0')

self.delta: 324.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0093, 0.0123, 0.0185, 0.0247, 0.0370, 0.0494,
        0.0741, 0.0988, 0.1481, 0.1975, 0.2963, 0.3951, 0.5926, 0.7901],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 321.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0093, 0.0125, 0.0187, 0.0249, 0.0374, 0.0498,
        0.0748, 0.0997, 0.1495, 0.1994, 0.2991, 0.3988, 0.5981, 0.7975],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 324.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0093, 0.0123, 0.0185, 0.0247, 0.0370, 0.0494,
        0.0741, 0.0988, 0.1481, 0.1975, 0.2963, 0.3951, 0.5926, 0.7901],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 324.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0093, 0.0123, 0.0185, 0.0247, 0.0370, 0.0494,
        0.0741, 0.0988, 0.1481, 0.1975, 0.2963, 0.3951, 0.5926, 0.7901],
       device='cuda:0')

self.delta: 325.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0092, 0.0123, 0.0185, 0.0246, 0.0369, 0.0492,
        0.0738, 0.0985, 0.1477, 0.1969, 0.2954, 0.3938, 0.5908, 0.7877],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 323.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0093, 0.0124, 0.0186, 0.0248, 0.0372, 0.0495,
        0.0743, 0.0991, 0.1486, 0.1981, 0.2972, 0.3963, 0.5944, 0.7926],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 325.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0092, 0.0123, 0.0185, 0.0246, 0.0369, 0.0492,
        0.0738, 0.0985, 0.1477, 0.1969, 0.2954, 0.3938, 0.5908, 0.7877],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 323.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0093, 0.0124, 0.0186, 0.0248, 0.0372, 0.0495,
        0.0743, 0.0991, 0.1486, 0.1981, 0.2972, 0.3963, 0.5944, 0.7926],
       device='cuda:0')

Performing scale reparameterization ...
Validating ...
Test: [0/250]   Time 6.004 (6.004)      Loss 0.8122 (0.8122)    Prec@1 88.000 (88.000)  Prec@5 98.000 (98.000)
Test: [100/250] Time 3.360 (3.387)      Loss 1.7215 (1.2158)    Prec@1 65.500 (79.584)  Prec@5 90.000 (94.243)
Test: [200/250] Time 3.360 (3.374)      Loss 1.5988 (1.4869)    Prec@1 89.500 (74.448)  Prec@5 95.500 (90.771)
 * Prec@1 73.616 Prec@5 90.414 Time 842.767