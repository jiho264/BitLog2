Namespace(model='deit_small', dataset='dataset/imagenet/', calib_batchsize=32, val_batchsize=200, num_workers=8, device='cuda', print_freq=100, seed=0, w_bits=4, a_bits=4, log_quant_scheme='BitLog2_Half_17')
Building dataloader ...
Building model ...
Performing initial quantization ...
self.delta: 302.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0033, 0.0066, 0.0099, 0.0132, 0.0199, 0.0265, 0.0397, 0.0530,
        0.0795, 0.1060, 0.1589, 0.2119, 0.3179, 0.4238, 0.6358, 0.8477],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 308.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0032, 0.0065, 0.0097, 0.0130, 0.0195, 0.0260, 0.0390, 0.0519,
        0.0779, 0.1039, 0.1558, 0.2078, 0.3117, 0.4156, 0.6234, 0.8312],
       device='cuda:0')

self.delta: 325.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0092, 0.0123, 0.0185, 0.0246, 0.0369, 0.0492,
        0.0738, 0.0985, 0.1477, 0.1969, 0.2954, 0.3938, 0.5908, 0.7877],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 323.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0093, 0.0124, 0.0186, 0.0248, 0.0372, 0.0495,
        0.0743, 0.0991, 0.1486, 0.1981, 0.2972, 0.3963, 0.5944, 0.7926],
       device='cuda:0')

self.delta: 328.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0030, 0.0061, 0.0091, 0.0122, 0.0183, 0.0244, 0.0366, 0.0488,
        0.0732, 0.0976, 0.1463, 0.1951, 0.2927, 0.3902, 0.5854, 0.7805],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 323.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0093, 0.0124, 0.0186, 0.0248, 0.0372, 0.0495,
        0.0743, 0.0991, 0.1486, 0.1981, 0.2972, 0.3963, 0.5944, 0.7926],
       device='cuda:0')

self.delta: 330.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0030, 0.0061, 0.0091, 0.0121, 0.0182, 0.0242, 0.0364, 0.0485,
        0.0727, 0.0970, 0.1455, 0.1939, 0.2909, 0.3879, 0.5818, 0.7758],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 320.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0063, 0.0094, 0.0125, 0.0188, 0.0250, 0.0375, 0.0500,
        0.0750, 0.1000, 0.1500, 0.2000, 0.3000, 0.4000, 0.6000, 0.8000],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 333.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0030, 0.0060, 0.0090, 0.0120, 0.0180, 0.0240, 0.0360, 0.0480,
        0.0721, 0.0961, 0.1441, 0.1922, 0.2883, 0.3844, 0.5766, 0.7688],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 319.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0063, 0.0094, 0.0125, 0.0188, 0.0251, 0.0376, 0.0502,
        0.0752, 0.1003, 0.1505, 0.2006, 0.3009, 0.4013, 0.6019, 0.8025],
       device='cuda:0')

self.delta: 326.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0123, 0.0184, 0.0245, 0.0368, 0.0491,
        0.0736, 0.0982, 0.1472, 0.1963, 0.2945, 0.3926, 0.5890, 0.7853],
       device='cuda:0')

self.delta: 323.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0062, 0.0093, 0.0124, 0.0186, 0.0248, 0.0372, 0.0495,
        0.0743, 0.0991, 0.1486, 0.1981, 0.2972, 0.3963, 0.5944, 0.7926],
       device='cuda:0')

self.delta: 327.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0031, 0.0061, 0.0092, 0.0122, 0.0183, 0.0245, 0.0367, 0.0489,
        0.0734, 0.0979, 0.1468, 0.1957, 0.2936, 0.3914, 0.5872, 0.7829],
       device='cuda:0')

self.delta: 333.0
17 tensor([-99999,      0,     10,     15,     20,     25,     30,     35,     40,
            45,     50,     55,     60,     65,     70,     75,     80],
       device='cuda:0', dtype=torch.int32)
17 tensor([  0.,   1.,   2.,   3.,   4.,   6.,   8.,  12.,  16.,  24.,  32.,  48.,
         64.,  96., 128., 192., 256.], device='cuda:0')
17 tensor([0.0000, 0.0030, 0.0060, 0.0090, 0.0120, 0.0180, 0.0240, 0.0360, 0.0480,
        0.0721, 0.0961, 0.1441, 0.1922, 0.2883, 0.3844, 0.5766, 0.7688],
       device='cuda:0')

Performing scale reparameterization ...
Validating ...
Test: [0/250]   Time 4.411 (4.411)      Loss 0.6057 (0.6057)    Prec@1 85.500 (85.500)  Prec@5 99.500 (99.500)
Test: [100/250] Time 1.960 (1.849)      Loss 2.0687 (1.0170)    Prec@1 56.500 (76.916)  Prec@5 86.500 (94.158)
Test: [200/250] Time 1.967 (1.912)      Loss 0.8278 (1.2435)    Prec@1 85.500 (72.229)  Prec@5 94.000 (90.826)
 * Prec@1 71.540 Prec@5 90.444 Time 481.324