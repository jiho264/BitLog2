Namespace(model='vit_small', dataset='dataset/imagenet/', calib_batchsize=32, val_batchsize=200, num_workers=8, device='cuda', print_freq=100, seed=0, w_bits=4, a_bits=4, log_quant_scheme='BitLog2_Single_17')
Building dataloader ...
Building model ...
Performing initial quantization ...
self.delta: 44573.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.2435e-05, 4.4870e-05, 8.9740e-05, 1.7948e-04, 3.5896e-04,
        7.1792e-04, 1.4358e-03, 2.8717e-03, 5.7434e-03, 1.1487e-02, 2.2974e-02,
        4.5947e-02, 9.1894e-02, 1.8379e-01, 3.6758e-01, 7.3515e-01],
       device='cuda:0')
self.delta: 42296.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.3643e-05, 4.7286e-05, 9.4572e-05, 1.8914e-04, 3.7829e-04,
        7.5657e-04, 1.5131e-03, 3.0263e-03, 6.0526e-03, 1.2105e-02, 2.4210e-02,
        4.8421e-02, 9.6841e-02, 1.9368e-01, 3.8737e-01, 7.7473e-01],
       device='cuda:0')
self.delta: 47269.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.1156e-05, 4.2311e-05, 8.4622e-05, 1.6924e-04, 3.3849e-04,
        6.7698e-04, 1.3540e-03, 2.7079e-03, 5.4158e-03, 1.0832e-02, 2.1663e-02,
        4.3326e-02, 8.6653e-02, 1.7331e-01, 3.4661e-01, 6.9322e-01],
       device='cuda:0')
self.delta: 49194.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.0328e-05, 4.0655e-05, 8.1311e-05, 1.6262e-04, 3.2524e-04,
        6.5049e-04, 1.3010e-03, 2.6019e-03, 5.2039e-03, 1.0408e-02, 2.0816e-02,
        4.1631e-02, 8.3262e-02, 1.6652e-01, 3.3305e-01, 6.6610e-01],
       device='cuda:0')
self.delta: 49185.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.0331e-05, 4.0663e-05, 8.1326e-05, 1.6265e-04, 3.2530e-04,
        6.5060e-04, 1.3012e-03, 2.6024e-03, 5.2048e-03, 1.0410e-02, 2.0819e-02,
        4.1639e-02, 8.3277e-02, 1.6655e-01, 3.3311e-01, 6.6622e-01],
       device='cuda:0')
self.delta: 49007.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.0405e-05, 4.0810e-05, 8.1621e-05, 1.6324e-04, 3.2648e-04,
        6.5297e-04, 1.3059e-03, 2.6119e-03, 5.2237e-03, 1.0447e-02, 2.0895e-02,
        4.1790e-02, 8.3580e-02, 1.6716e-01, 3.3432e-01, 6.6864e-01],
       device='cuda:0')
self.delta: 48297.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.0705e-05, 4.1410e-05, 8.2821e-05, 1.6564e-04, 3.3128e-04,
        6.6257e-04, 1.3251e-03, 2.6503e-03, 5.3005e-03, 1.0601e-02, 2.1202e-02,
        4.2404e-02, 8.4809e-02, 1.6962e-01, 3.3923e-01, 6.7847e-01],
       device='cuda:0')
self.delta: 49208.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.0322e-05, 4.0644e-05, 8.1288e-05, 1.6258e-04, 3.2515e-04,
        6.5030e-04, 1.3006e-03, 2.6012e-03, 5.2024e-03, 1.0405e-02, 2.0810e-02,
        4.1619e-02, 8.3238e-02, 1.6648e-01, 3.3295e-01, 6.6591e-01],
       device='cuda:0')
self.delta: 49211.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.0321e-05, 4.0641e-05, 8.1283e-05, 1.6257e-04, 3.2513e-04,
        6.5026e-04, 1.3005e-03, 2.6010e-03, 5.2021e-03, 1.0404e-02, 2.0808e-02,
        4.1617e-02, 8.3233e-02, 1.6647e-01, 3.3293e-01, 6.6587e-01],
       device='cuda:0')
self.delta: 49183.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.0332e-05, 4.0664e-05, 8.1329e-05, 1.6266e-04, 3.2532e-04,
        6.5063e-04, 1.3013e-03, 2.6025e-03, 5.2051e-03, 1.0410e-02, 2.0820e-02,
        4.1640e-02, 8.3281e-02, 1.6656e-01, 3.3312e-01, 6.6625e-01],
       device='cuda:0')
self.delta: 49170.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.0338e-05, 4.0675e-05, 8.1350e-05, 1.6270e-04, 3.2540e-04,
        6.5080e-04, 1.3016e-03, 2.6032e-03, 5.2064e-03, 1.0413e-02, 2.0826e-02,
        4.1651e-02, 8.3303e-02, 1.6661e-01, 3.3321e-01, 6.6642e-01],
       device='cuda:0')
self.delta: 49204.0
17 tensor([-100000,       0,      10,      20,      30,      40,      50,      60,
             70,      80,      90,     100,     110,     120,     130,     140,
            150], device='cuda:0', dtype=torch.int32)
17 tensor([0.0000e+00, 1.0000e+00, 2.0000e+00, 4.0000e+00, 8.0000e+00, 1.6000e+01,
        3.2000e+01, 6.4000e+01, 1.2800e+02, 2.5600e+02, 5.1200e+02, 1.0240e+03,
        2.0480e+03, 4.0960e+03, 8.1920e+03, 1.6384e+04, 3.2768e+04],
       device='cuda:0')
17 tensor([0.0000e+00, 2.0324e-05, 4.0647e-05, 8.1294e-05, 1.6259e-04, 3.2518e-04,
        6.5035e-04, 1.3007e-03, 2.6014e-03, 5.2028e-03, 1.0406e-02, 2.0811e-02,
        4.1623e-02, 8.3245e-02, 1.6649e-01, 3.3298e-01, 6.6596e-01],
       device='cuda:0')
Performing scale reparameterization ...
Validating ...
Test: [0/250]	Time 3.301 (3.301)	Loss 0.9214 (0.9214)	Prec@1 76.000 (76.000)	Prec@5 95.000 (95.000)
Test: [100/250]	Time 0.851 (0.875)	Loss 1.4161 (1.2287)	Prec@1 64.500 (69.401)	Prec@5 90.500 (90.035)
Test: [200/250]	Time 0.850 (0.863)	Loss 0.9053 (1.4862)	Prec@1 79.500 (64.945)	Prec@5 93.500 (86.376)
 * Prec@1 64.456 Prec@5 86.156 Time 215.171
